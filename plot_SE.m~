function [] = plot_SE()

% simulation parameters
Ks = [50 500];
MC_simulation = 10;
inter_max = 20;

se_tau2 = zeros(inter_max+1,1);
se_mse = zeros(inter_max+1,1);

figure
for index = 1:length(Ks)
    
    %% Problem parameters
    K = Ks(index);
    N = 4000;
    M = 2000;
    delta = M/N;
    rho = K/N;
    sigmaw2 = 0.0*1*K/N;
    
    %% Numerical simulation
    % starts a new set of simulatios
    [ampsim_tau2, ampsim_mse] = mseagainstt(N, K, MC_simulation, M, sigmaw2, inter_max); 
    % loads the simulation results from a file, e.g. "SE K=50.mat"
%     load(sprintf('SE K=%d',K));
    
    %% SE prediction
    se_mse(1) = K/N;
    se_tau2(1) = sigmaw2 + 1/delta*se_mse(1);
    for i=2:inter_max+1
        [ se_tau2(i), se_mse(i) ] = func_SE_MC(se_tau2(i-1), delta, rho, sigmaw2);
    end
    
    %% plots in dB
    subplot(length(Ks),2,2*index-1)
    plot([0:inter_max], 10*log10(ampsim_tau2),'m-');
    hold on
    plot([0:inter_max], 10*log10(ampsim_mse),'c-');
    plot([0:inter_max], 10*log10(se_tau2),'r*');
    plot([0:inter_max], 10*log10(se_mse),'bx');
    
    ylabel('MSE [dB]')
    xlabel('iteration #')
    title(sprintf('K=%d, rho=%.3f',K,K/N))
    %% plots in magnitude    
    subplot(length(Ks),2,2*index)  
    plot([0:inter_max], ampsim_tau2,'m-');
    hold on
    plot([0:inter_max], ampsim_mse,'c-');
    plot([0:inter_max], se_tau2,'r*');
    plot([0:inter_max], se_mse,'bx');

    legend('Simulation tau2', 'Simulation MSE', 'SE tau2', 'SE MSE')
    ylabel('MSE [dB]')
    xlabel('iteration #')
    title(sprintf('K=%d, rho=%.3f',K,K/N))
end
end

function [] = single_subplot()
